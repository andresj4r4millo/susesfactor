!function(){"use strict";var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function e(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var s=function(){return(s=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function t(e,a,s,u){return new(s=s||Promise)(function(n,t){function r(e){try{o(u.next(e))}catch(e){t(e)}}function i(e){try{o(u.throw(e))}catch(e){t(e)}}function o(e){var t;e.done?n(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(r,i)}o((u=u.apply(e,a||[])).next())})}function u(n,r){var i,o,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,o&&(a=2&t[0]?o.return:t[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,t[1])).done)return a;switch(o=0,(t=a?[2&t[0],a.value]:t)[0]){case 0:case 1:a=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,o=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){s.label=t[1];break}if(6===t[0]&&s.label<a[1]){s.label=a[1],a=t;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(t);break}a[2]&&s.ops.pop(),s.trys.pop();continue}t=r.call(n,s)}catch(e){t=[6,e],o=0}finally{i=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}}function p(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&r>=e.length?void 0:e)&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}var i=(n.PAGE_INIT="pageInit",n.PAGE_LOADED="pageLoaded",n.PAGE_COMPLETED="pageCompleted",n.PAGE_UNLOAD="pageUnload",n.Request_START="requestStart",n.Request_END="requestEnd",n.DeferredLastAPIEvent=new n(n.DEFERRED_LAST_API_RESPONSE="deferredLastAPIEvent"),n.RequestStartEvent=new n(n.Request_START),n.RequestEndEvent=new n(n.Request_END),n);function n(e,t){this.eventName=e,this.detail=t}var o=(a.prototype.onInit=function(){},a);function a(e){this.entity=e}var l=function(){this.supportServiceWorker=!1,this.monitorFetch=!1,this.monitorXmlHttpRequest=!1,this.monitorRequestUrlBlockList=null},c=["EID","ST","TOK"],d=["MEM","NRE","NWR"],h=["MEM","NRE","NWR","SCPU","SQLC","SQLT","SVT","UCPU","CPU","FRE","FWR","CCON","CSUP","CLOC","CEXT","CREM"],f="OPTR_REQUEST_REFERRER",g="OPTR_REQUEST_START",v=(Object.defineProperty(m.prototype,"url",{get:function(){return this._url},set:function(e){var n=this,t=e.indexOf("#"),t=(e=0<=t?e.substring(0,t):e).indexOf("?");if(-1!==t){this._url=e.substring(0,t);t=e.substring(t+1);if(t)try{t.split("&").map(function(e){return e.trim()}).filter(Boolean).forEach(function(e){var t=e.split("="),e=(null!==(e=t[0])&&void 0!==e?e:"").trim();e&&(t=decodeURIComponent((null!==(t=t[1])&&void 0!==t?t:"").trim()),n.params.set(e,t))})}catch(e){console.error(e)}}else this._url=e},enumerable:!1,configurable:!0}),m.prototype.append=function(e,t){return e&&(Array.isArray(t)||"string"==typeof t||(t=""+t),this.params.set(e,t)),this},m.prototype.appendURLParams=function(e){var t,n;try{for(var r=p(e.params),i=r.next();!i.done;i=r.next()){var o=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}(i.value,2),a=o[0],s=o[1];this.append(a,s)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return this},m.prototype.get=function(e){return null!==(e=this.params.get(e))&&void 0!==e?e:null},m.prototype.toString=function(){if(0===this.params.size)return this._url;var n=[];this.params.forEach(function(e,t){Array.isArray(e)?e.forEach(function(e){n.push(t+"="+encodeURIComponent(""+e))}):n.push(t+"="+encodeURIComponent(e))});var e=n.join("&");return this._url?this._url+"?"+e:e},m.prototype.forEach=function(n){this.params.forEach(function(e,t){n(t,e)})},m.prototype.toJSON=function(){var n={};return this.params.forEach(function(e,t){n[t]=e}),n},m);function m(e){this.params=new Map,this._url="",e&&(this.url=e)}var y=null;function E(){var e;if(y)return y;var t=null===(e=window.pageHeaderJsonData)||void 0===e?void 0:e.pageInfo;if(t&&(n="NONE",y={moduleId:null!==(e=t.moduleId)&&void 0!==e?e:n,pageId:null!==(e=t.pageId)&&void 0!==e?e:n,pageQualifier:null!==(t=t.pageQualifier)&&void 0!==t?t:n}),y)return y;var n=null!==(n=document.querySelector("meta[name=pageInfo]"))&&void 0!==n?n:null;if(n){n=n.content;if(n)try{y=JSON.parse(n)}catch(e){}}return y}var R=null;function w(){if(R)return R;var e=null!==(e=document.querySelector("meta[name=pageMetaAttributes]"))&&void 0!==e?e:null,e=(null==e?void 0:e.content)||null;if(e)try{R=JSON.parse(e)}catch(e){}return R}var S,q=null;function P(){if(q)return q;var e=null!==(e=document.getElementById("PerfLog.requestStats"))&&void 0!==e?e:null,e=null!==(e=null==e?void 0:e.content)&&void 0!==e?e:null;return q=D(e)}function D(e){if(!e)return null;var n={};return new v("?"+e).forEach(function(e,t){Array.isArray(t)||(-1!==c.indexOf(e)?n[e]=decodeURIComponent(t):-1!==d.indexOf(e)?n[e]=parseFloat(decodeURIComponent(t)):-1!==h.indexOf(e)?n[e]=parseInt(t):n[e]=decodeURIComponent(t))}),n}function b(){return"string"==typeof window.ajaxSecKey?window.ajaxSecKey:null}var I=(T.prototype.initialEventsStats=function(){var e,t,n;this.eventStats||(this.baseEventId?(t={EID:this.baseEventId+"-"+ ++this.subEventId,ST:Date.now()},h.forEach(function(e){t[e]=0}),this.eventToken&&(t.TOK=this.eventToken),this.eventStats=t):((n=P())&&(this.baseEventId=null!==(e=n.EID)&&void 0!==e?e:null,this.eventToken=null!==(e=n.TOK)&&void 0!==e?e:null),this.eventStats=n))},T.prototype.updateEventsStatsByStr=function(e){var t,n;this.eventStats&&e&&(!(t=D(e))||(n=this.eventStats).EID===t.EID&&h.forEach(function(e){"number"==typeof n[e]&&"number"==typeof t[e]&&(n[e]+=t[e])}))},T.prototype.clear=function(){this.eventStats=null,this.lastAPIEndTime=0},T.prototype.getNextCallIdStrForManualAction=function(){return this.callMainId+"-"+ ++this.subEventId+"-Y"},T.prototype.getNextCallIdStringForSendMetrics=function(){return this.callMainId+"-"+this.callSubId++},T);function T(){this.firstAPIStartTime=Date.now(),this.lastAPIEndTime=0,this.pendingAPICallCount=0,this.callMainId=Math.floor(1e10*Math.random()),this.callSubId=0,this.subEventId=0,this.eventId=null,this.baseEventId=null,this.eventToken=null,this.eventStats=null}var A=(L.prototype.endTrack=function(e){var t;this.renderTime=e,this.cssLinkCount=document.querySelectorAll("link[href]").length,this.imageCount=(e=document.querySelectorAll("img, .sf-img"))&&e.length||0,this.scriptTagCount=document.querySelectorAll("script[src]").length,this.scriptTagNoCacheCount=(void(t=0)!==window.performance&&"function"==typeof window.performance.getEntriesByType&&performance.getEntriesByType("resource").forEach(function(e){e.initiatorType&&"script"===e.initiatorType&&0!=e.transferSize&&t++}),t)},L.prototype.clear=function(){this.renderTime=0,this.cssLinkCount=0,this.imageCount=0,this.scriptTagCount=0},L);function L(){this.enableSendMetrics=!0,this.cssLinkCount=0,this.scriptTagCount=0,this.scriptTagNoCacheCount=0,this.imageCount=0,this.apiCallCount=0,this.renderTime=0}function C(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})}var x=(H.prototype.startTrack=function(){var e=C(),t={type:0,requestId:e,start:Date.now(),end:0,token:""},n=C();return t.token="0100050001"+e+"29820909-1501-babe-face-000000000003"+n+"HTTP    ;",this.itemsMap.set(e,t),t},H.prototype.endTrack=function(e){e=this.itemsMap.get(e);e&&(e.end=Date.now())},H.prototype.initPageTrack=function(e,t){t={type:1,requestId:e,start:t,end:Date.now(),token:""};return this.itemsMap.set(e,t),t},H.prototype.get=function(e){return null!==(e=this.itemsMap.get(e))&&void 0!==e?e:null},H.prototype.clear=function(){return this.itemsMap.clear(),this},H.prototype.toArray=function(){var n=[];return this.itemsMap.forEach(function(e,t){e&&e.end&&n.push(t+"!"+e.start+"!"+e.end+"!"+e.type)}),n},H);function H(){this.itemsMap=new Map}function O(e){if(0!==e.indexOf("http://")&&0!==e.indexOf("https://"))return!0;var t=function(){var e,t=null!==(e=window.pageHeaderJsonData)&&void 0!==e?e:null,n=null;if(n=null!==(e=null!==(e=null==t?void 0:t.defaultBaseUrl)&&void 0!==e?e:null==t?void 0:t.baseUrl)&&void 0!==e?e:null)return n;var t=w();return n=null!==(t=null!==(e=null==t?void 0:t.defaultBaseUrl)&&void 0!==e?e:null==t?void 0:t.baseUrl)&&void 0!==t?t:null}();return!t||0===e.indexOf(t)}function M(e){return 0===e.indexOf("http")&&0!==e.indexOf(window.location.origin)}var _=null!==(De=window.fetch)&&void 0!==De?De:function(){throw new Error("fetch is not supported!")},k=null,N=(Object.defineProperty(U.prototype,"requestUrl",{get:function(){return this._requestUrl},enumerable:!1,configurable:!0}),U.prototype.setRequestHeader=function(e,t){var n;null!==(n=this.appendHeaders)&&void 0!==n||(this.appendHeaders={}),this.appendHeaders[e.toLowerCase()]=t},U.prototype.getRequestHeader=function(e){if(!this.appendHeaders)return null;var e=e.toLowerCase();return null!==(e=this.appendHeaders[e])&&void 0!==e?e:null},U.prototype.getResponseHeader=function(e){var t;return null!==(e=null===(t=this.requestResponse)||void 0===t?void 0:t.headers.get(e))&&void 0!==e?e:null},U.prototype.onRequestStart=function(){var e;try{null!==(e=null==k?void 0:k.onRequestStart)&&void 0!==e&&e.call(k,this)}catch(e){console.error(e)}},U.prototype.onResponseEnd=function(){var e;try{null!==(e=null==k?void 0:k.onResponseEnd)&&void 0!==e&&e.call(k,this)}catch(e){console.error(e)}},U.prototype.send=function(o,a){return t(this,void 0,void 0,function(){var t,n,r,i=this;return u(this,function(e){switch(e.label){case 0:"string"==typeof o?(this._requestUrl=o,null==a||!a.headers||a.headers instanceof Headers||Array.isArray(a.headers)||(t=a.headers,Object.keys(t).forEach(function(e){i.setRequestHeader(e.toLowerCase(),t[e])}))):o instanceof window.Request&&(this._requestUrl=o.url,(a=null==a?{}:a).headers||(o.headers.forEach(function(e,t){i.setRequestHeader(t.toLowerCase(),e)}),a.method=o.method,a.mode=o.mode,a.credentials=o.credentials,a.cache=o.cache,a.integrity=o.integrity,a.keepalive=o.keepalive,a.redirect=o.redirect,a.referrer=o.referrer,a.referrerPolicy=o.referrerPolicy,a.signal=o.signal)),this.onRequestStart(),n=s(s({},a),{headers:s({},this.appendHeaders)}),e.label=1;case 1:return e.trys.push([1,3,,4]),r=this,[4,_(o,n)];case 2:return r.requestResponse=e.sent(),this.onResponseEnd(),[2,this.requestResponse];case 3:throw r=e.sent(),this.onResponseEnd(),r;case 4:return[2]}})})},U);function U(){this.requestId=null,this.appendHeaders=null,this.requestResponse=null}var j=null,G=window.XMLHttpRequest,F=(Object.defineProperty(B.prototype,"readyState",{get:function(){return this.xmlHttpRequest.readyState},enumerable:!1,configurable:!0}),Object.defineProperty(B.prototype,"response",{get:function(){return this.xmlHttpRequest.response},enumerable:!1,configurable:!0}),Object.defineProperty(B.prototype,"responseText",{get:function(){return this.xmlHttpRequest.responseText},enumerable:!1,configurable:!0}),Object.defineProperty(B.prototype,"responseType",{get:function(){return this.xmlHttpRequest.responseType},set:function(e){this.xmlHttpRequest.responseType=e},enumerable:!1,configurable:!0}),Object.defineProperty(B.prototype,"responseURL",{get:function(){return this.xmlHttpRequest.responseURL},enumerable:!1,configurable:!0}),Object.defineProperty(B.prototype,"responseXML",{get:function(){return this.xmlHttpRequest.responseXML},enumerable:!1,configurable:!0}),Object.defineProperty(B.prototype,"status",{get:function(){return this.xmlHttpRequest.status},enumerable:!1,configurable:!0}),Object.defineProperty(B.prototype,"statusText",{get:function(){return this.xmlHttpRequest.statusText},enumerable:!1,configurable:!0}),Object.defineProperty(B.prototype,"timeout",{get:function(){return this.xmlHttpRequest.timeout},set:function(e){this.xmlHttpRequest.timeout=e},enumerable:!1,configurable:!0}),Object.defineProperty(B.prototype,"upload",{get:function(){return this.xmlHttpRequest.upload},enumerable:!1,configurable:!0}),Object.defineProperty(B.prototype,"DONE",{get:function(){return this.xmlHttpRequest.DONE},enumerable:!1,configurable:!0}),Object.defineProperty(B.prototype,"HEADERS_RECEIVED",{get:function(){return this.xmlHttpRequest.HEADERS_RECEIVED},enumerable:!1,configurable:!0}),Object.defineProperty(B.prototype,"LOADING",{get:function(){return this.xmlHttpRequest.LOADING},enumerable:!1,configurable:!0}),Object.defineProperty(B.prototype,"OPENED",{get:function(){return this.xmlHttpRequest.OPENED},enumerable:!1,configurable:!0}),Object.defineProperty(B.prototype,"UNSENT",{get:function(){return this.xmlHttpRequest.UNSENT},enumerable:!1,configurable:!0}),Object.defineProperty(B.prototype,"withCredentials",{get:function(){return this.xmlHttpRequest.withCredentials},set:function(e){this.xmlHttpRequest.withCredentials=e},enumerable:!1,configurable:!0}),B.prototype.abort=function(){this.xmlHttpRequest.abort()},B.prototype.getAllResponseHeaders=function(){return this.xmlHttpRequest.getAllResponseHeaders()},B.prototype.getResponseHeader=function(e){return this.xmlHttpRequest.getResponseHeader(e)},B.prototype.overrideMimeType=function(e){this.xmlHttpRequest.overrideMimeType(e)},B.prototype.setRequestHeader=function(e,t){var n;null!==(n=this.appendHeaders)&&void 0!==n||(this.appendHeaders={});e=e.toLowerCase();this.appendHeaders[e]=t},B.prototype.getRequestHeader=function(e){if(!this.appendHeaders)return null;var e=e.toLowerCase();return null!==(e=this.appendHeaders[e])&&void 0!==e?e:null},Object.defineProperty(B.prototype,"requestUrl",{get:function(){return this._requestUrl},enumerable:!1,configurable:!0}),Object.defineProperty(B.prototype,"onabort",{get:function(){return this.xmlHttpRequest.onabort},set:function(e){this.xmlHttpRequest.onabort=e},enumerable:!1,configurable:!0}),Object.defineProperty(B.prototype,"onerror",{get:function(){return this.xmlHttpRequest.onerror},set:function(e){this.xmlHttpRequest.onerror=e},enumerable:!1,configurable:!0}),Object.defineProperty(B.prototype,"onload",{get:function(){return this.xmlHttpRequest.onload},set:function(e){this.xmlHttpRequest.onload=e},enumerable:!1,configurable:!0}),Object.defineProperty(B.prototype,"onloadend",{get:function(){return this.xmlHttpRequest.onloadend},set:function(e){this.xmlHttpRequest.onloadend=e},enumerable:!1,configurable:!0}),Object.defineProperty(B.prototype,"onloadstart",{get:function(){return this.xmlHttpRequest.onloadstart},set:function(e){this.xmlHttpRequest.onloadstart=e},enumerable:!1,configurable:!0}),Object.defineProperty(B.prototype,"onprogress",{get:function(){return this.xmlHttpRequest.onprogress},set:function(e){this.xmlHttpRequest.onprogress=e},enumerable:!1,configurable:!0}),Object.defineProperty(B.prototype,"ontimeout",{get:function(){return this.xmlHttpRequest.onprogress},set:function(e){this.xmlHttpRequest.ontimeout=e},enumerable:!1,configurable:!0}),Object.defineProperty(B.prototype,"onreadystatechange",{get:function(){return this.xmlHttpRequest.onreadystatechange},set:function(e){this.xmlHttpRequest.onreadystatechange=e},enumerable:!1,configurable:!0}),B.prototype.open=function(e,t,n,r,i){void 0===n&&(n=!0),void 0===r&&(r=null),void 0===i&&(i=null);var o=e.toLowerCase();if("connect"===o||"trace"===o||"track"===o)throw new Error("18");this._requestUrl=t,this.appendHeaders&&(this.appendHeaders={}),this.xmlHttpRequest.open(e,t,!!n,r,i)},B.prototype.send=function(e){var t,n=this;this.onRequestStart(),this.appendHeaders&&(t=this.appendHeaders,Object.keys(this.appendHeaders).forEach(function(e){n.xmlHttpRequest.setRequestHeader(e,t[e])})),this.xmlHttpRequest.send(e)},B.prototype.addEventListener=function(e,t,n){this.xmlHttpRequest.addEventListener(e,t,n)},B.prototype.removeEventListener=function(e,t,n){this.xmlHttpRequest.removeEventListener(e,t,n)},B.prototype.dispatchEvent=function(e){return this.xmlHttpRequest.dispatchEvent(e)},B.prototype.toString=function(){return"XMLHttpRequest"},B.prototype.onRequestStart=function(){var e;try{null!==(e=null==j?void 0:j.onRequestStart)&&void 0!==e&&e.call(j,this)}catch(e){console.error(e)}},B.prototype.onResponseEnd=function(){var e;try{null!==(e=null==j?void 0:j.onResponseEnd)&&void 0!==e&&e.call(j,this)}catch(e){console.error(e)}},B.UNSENT=G.UNSENT,B.OPENED=G.OPENED,B.HEADERS_RECEIVED=G.HEADERS_RECEIVED,B.LOADING=G.LOADING,B.DONE=G.DONE,B);function B(){var e=this;this.requestId=null,this.appendHeaders=null,this.xmlHttpRequest=new G,this.xmlHttpRequest.addEventListener("loadend",function(){e.onResponseEnd()})}var X=null,Q="X-Ajax-Token",V="Content-Type",J="X-CSRF-Token",W="X-Event-ID",K="OPTR_CXT",z="X-Req-Hash",Y="X-Request-Stats",Z="X-SAP-Page-Info",$="X-Subaction";function ee(){var e;if(X)return X;var t=new v,n=null!==(e=null===(e=window.pageHeaderJsonData)||void 0===e?void 0:e.companyId)&&void 0!==e?e:null===(n=w())||void 0===n?void 0:n.companyId;n&&t.append("companyId",n);var n=null!==(n=null===(n=window.pageHeaderJsonData)||void 0===n?void 0:n.pageInfo)&&void 0!==n?n:E();n&&(n.moduleId&&t.append("moduleId",n.moduleId),n.pageId&&t.append("pageId",n.pageId),n.pageQualifier&&t.append("pageQualifier",n.pageQualifier));n=null===(n=window.pageHeaderJsonData)||void 0===n?void 0:n.uiVersion;return n&&t.append("uiVersion",n),X=t.toString()}var te,ne=(e(re,te=o),re.prototype.onInit=function(){var e=this;this.requestStateData=this.entity.get(I.name),this.renderMetricsData=this.entity.get(A.name),this.requestMetricsData=this.entity.get(x.name),this.featuresData=this.entity.get(l.name),this.entity.once(i.PAGE_COMPLETED,function(){e.pageCompleted=!0,e.requestStateData.lastAPIEndTime=Date.now(),e.checkAndTriggerDeferredLastAPIResponse()}),this.entity.get(l.name).supportServiceWorker?this.initServiceWorker():this.initAPIRequestWrapper()},re.prototype.checkAndTriggerDeferredLastAPIResponse=function(){var e,t=this;this.pageCompleted&&(0<this.requestStateData.pendingAPICallCount||0<this.deferredTimerHandle||((e=Date.now()-this.requestStateData.lastAPIEndTime)<100?this.deferredTimerHandle=window.setTimeout(function(){t.deferredTimerHandle=0,t.checkAndTriggerDeferredLastAPIResponse()},100-e):this.entity.emit(i.DeferredLastAPIEvent)))},re.prototype.initAPIRequestWrapper=function(){var e,r,i=this,t={onRequestStart:function(e){var t,n;n=!!(t=e).getRequestHeader("x-allow-cors"),M(t.requestUrl)&&!n||((n=b())&&(t.getRequestHeader(Q)||t.setRequestHeader(Q,n),t.getRequestHeader(J)||t.setRequestHeader(J,n)),(n=ee())&&!t.getRequestHeader(Z)&&t.setRequestHeader(Z,n)),i.onRequestStart(e)},onResponseEnd:function(e){i.onResponseEnd(e)}};this.featuresData.monitorXmlHttpRequest&&(window.XMLHttpRequest=(j=e=void 0===(e=t)?null:e,F),window.DEF_FLAG_OF_XMLHTTPREQUEST_JS=!0),this.featuresData.monitorFetch&&(window.fetch=(r=t,function(e,t){var n=new N;return k=r,n.send(e,t)}))},re.prototype.initServiceWorker=function(){console.warn("This feature is not supported.")},re.prototype.checkIsValidRequest=function(e){if(!this.renderMetricsData.enableSendMetrics)return!1;if(!O(e.requestUrl))return!1;var t=this.featuresData,n=e.requestUrl,t=t.monitorRequestUrlBlockList;return!Array.isArray(t)||!t.some(function(e){return e.test(n)})},re.prototype.onRequestStart=function(e){var t;this.checkIsValidRequest(e)&&(console.log("Req in Event: "+e.requestUrl),this.requestStateData.initialEventsStats(),M(e.requestUrl)||this.renderMetricsData.enableSendMetrics&&(t=this.requestMetricsData.startTrack(),e.requestId=t.requestId,e.setRequestHeader(K,t.token),(t=null===(t=this.requestStateData.eventStats)||void 0===t?void 0:t.EID)&&e.setRequestHeader(W,t)),this.entity.hasListener(i.Request_START)&&((t=i.RequestStartEvent).detail=e,this.entity.emit(t)),0===this.requestStateData.pendingAPICallCount&&this.pageCompleted&&!this.requestStateData.lastAPIEndTime&&(this.requestStateData.firstAPIStartTime=Date.now()),this.renderMetricsData.apiCallCount++,this.requestStateData.pendingAPICallCount++)},re.prototype.onResponseEnd=function(e){var t;this.checkIsValidRequest(e)&&(this.renderMetricsData.enableSendMetrics&&!M(e.requestUrl)&&(e.requestId&&this.requestMetricsData.endTrack(e.requestId),(t=e.getResponseHeader(Y))&&this.requestStateData.updateEventsStatsByStr(t)),this.entity.hasListener(i.Request_END)&&((t=i.RequestEndEvent).detail=e,this.entity.emit(t)),this.requestStateData.pendingAPICallCount--,this.requestStateData.pendingAPICallCount<=0&&(this.requestStateData.lastAPIEndTime=Date.now(),this.checkAndTriggerDeferredLastAPIResponse()))},re);function re(){var e=null!==te&&te.apply(this,arguments)||this;return e.pageCompleted=!1,e.deferredTimerHandle=0,e}var ie="abcdefghijklmnopqrstuvwxyz-_0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ";function oe(e){for(var t=[],n=e.length,r=100<n?100:n,i=0;i<r;i++)t[i]=0;for(i=0;i<n;i++){var o=i%100;t[o]+=e.charCodeAt(i),t[o]=t[o]%256}return function(e){for(var t=e.length,n="",r=0,r=0;r<=t-3;r+=3)n+=ie.charAt(e[r]>>>2),n+=ie.charAt((3&e[r])<<4|e[r+1]>>>4),n+=ie.charAt((15&e[r+1])<<2|e[r+2]>>>6),n+=ie.charAt(63&e[r+2]);return t%3==2?(n+=ie.charAt(e[r]>>>2),n+=ie.charAt((3&e[r])<<4|e[r+1]>>>4),n+=ie.charAt((15&e[r+1])<<2)):t%3==1&&(n+=ie.charAt(e[r]>>>2),n+=ie.charAt((3&e[r])<<4)),n}(t)}var ae,se=(e(ue,ae=o),ue.prototype.onInit=function(){this.requestStateData=this.entity.get(I.name)},ue.prototype.onBeforeSend=function(e){var t,n;return e.method="POST",e.headers=s(s({},e.headers),((t={})[V]="application/x-www-form-urlencoded",t[$]=1<this.requestStateData.callSubId?"1":"0",t[z]=oe(unescape(e.url)),t)),null!==(t=e.metadata)&&void 0!==t&&t.eventId&&(e.headers["X-Event-ID"]=null===(n=e.metadata)||void 0===n?void 0:n.eventId),t=e.headers,(n=b())&&(t[Q]||(t[Q]=n),t[J]||(t[J]=n)),(n=ee())&&!t[Z]&&(t[Z]=n),e},ue.prototype.send=function(n){var e,r,i,t={method:null!==(t=(n=this.onBeforeSend(n)).method)&&void 0!==t?t:"GET",body:null!==(e=n.body)&&void 0!==e?e:null};n.headers&&(t.headers=n.headers),!(e=E())||!(e=e.moduleId)||"NONE"===e.toUpperCase()?null!==(t=n.callback)&&void 0!==t&&t.call(n,!1):((r=null!==(e=n.sender)&&void 0!==e?e:new G).open(t.method,n.url,!0),i=null!==(e=n.headers)&&void 0!==e?e:{},Object.keys(i).forEach(function(e){var t=i[e];t&&r.setRequestHeader(e,t)}),r.send(t.body),r.onreadystatechange=function(){var e;if(r.readyState===XMLHttpRequest.DONE){var t=200<=r.status&&r.status<400;try{null!==(e=n.callback)&&void 0!==e&&e.call(n,!t)}catch(e){console.error(e)}}})},ue);function ue(){return null!==ae&&ae.apply(this,arguments)||this}var le=(pe.prototype.startTrack=function(){this.startTime=Date.now()},pe.prototype.endTrack=function(){this.endTime=Date.now()},pe.prototype.clear=function(){this.startTime=0,this.endTime=0,this.pageActionParams=null},pe);function pe(){this.pageAction=null,this.pageActionParams=null,this.initialPageActionParams=null,this.startTime=0,this.endTime=0}function ce(e,t){return e&&0<=t?""+(e-t):""}var de,he=(e(fe,de=v),fe.prototype.appendRenderMetricsData=function(e){return this.append("jsNum",e.scriptTagCount).append("jsNcNum",e.scriptTagNoCacheCount).append("cssNum",e.cssLinkCount).append("imgNum",e.imageCount).append("reqNum",e.apiCallCount).append("renderTime",e.renderTime),this},fe.prototype.appendStartAndEndTime=function(e,t){return this.append("ST",e).append("ET",t),this},fe.prototype.appendCallId=function(e){return this.append("callId",e),this},fe.prototype.appendRequestStateData=function(e){var t,n=this;e.eventId&&this.append("eventId",e.eventId);var r=e.eventStats;return r&&(r.ST&&this.append("ST",r.ST),1<e.callSubId&&this.append("ET",Date.now()),1===e.callSubId&&null!==(t=null===(t=window.performance)||void 0===t?void 0:t.timing)&&void 0!==t&&t.navigationStart&&this.append("STC",window.performance.timing.navigationStart).append("ETC",Date.now()),h.forEach(function(e){var t=r[e],t=parseInt(t+"");isNaN(t)||n.append(e,t)})),this},fe.prototype.appendPageInfoMetrics=function(){var e=null!==(e=null!==(e=null===(e=window.pageHeaderJsonData)||void 0===e?void 0:e.pageInfo)&&void 0!==e?e:null)&&void 0!==e?e:E();return e&&(e.moduleId&&this.append("moduleId",e.moduleId),e.pageId&&this.append("pageId",e.pageId),e.pageQualifier&&this.append("pageQualifier",e.pageQualifier)),this},fe.prototype.appendPageAction=function(e){return e&&("NoAction"===e||this.append("pageAction",e)),this},fe.prototype.appendPageActionParams=function(e){if(!e)return this;try{this.append("actionParams",JSON.stringify(e))}catch(e){console.error(e)}return this},fe.prototype.appendPerfPhaseInfo=function(){var e,n=this;return null!==(e=window.PerfPhase)&&void 0!==e&&e.tracking&&["TRS","TIP","TML","TSL"].forEach(function(e){var t=null===(t=null===(t=window.PerfPhase)||void 0===t?void 0:t.tracking)||void 0===t?void 0:t[e];t&&n.append(e,""+t)}),this},fe.prototype.appendRequestMetricsData=function(e,t){null!=t||(t="OPTR_INFO");e=e.toArray();return 0<e.length&&this.append(t,e),this},fe.prototype.appendToken=function(e){return e&&this.append("TOK",e),this},fe.prototype.appendTimingKPI=function(){var e=window.performance.navigation,t=window.performance.timing,n=null===(i=window.PerfPhase)||void 0===i?void 0:i.tracking;if(!e||!t)return this;var r=ce(e.redirectCount,0);r&&this.append("RED",r);var i=ce(t.responseStart,t.fetchStart);i&&this.append("TTB",i);e=t.navigationStart,r=ce(t.domLoading,e);r&&this.append("RSR",r);i=ce(t.domInteractive,e);i&&this.append("DIA",i);r=ce(t.domComplete,e);r&&this.append("DCP",r);i=t.responseEnd-e,r=ce(i,0);this.append("RTT",r);e=ce(t.responseStart,e);e&&this.append("CRT",e);t=ce(t.responseEnd,t.responseStart);t&&this.append("SRT",t);i=ce(null!==(n=null==n?void 0:n.TML)&&void 0!==n?n:0,i);return i&&this.append("UTML",i),this},fe.prototype.appendClientVer=function(){return this.append("VER","2"),this},fe);function fe(){return null!==de&&de.apply(this,arguments)||this}var ge,ve=(e(me,ge=o),me.prototype.onInit=function(){this.manualActionData=this.entity.get(le.name),this.requestStateData=this.entity.get(I.name)},me.prototype.startManualEvent=function(){this.manualActionData.startTrack()},me.prototype.endManualEvent=function(e,t){var n,r;e&&this.manualActionData.startTime&&(this.manualActionData.endTrack(),n=null!=e?e:this.manualActionData.pageAction,r=this.manualActionData.pageActionParams,e=new he(window.PerfLog.callURL).appendCallId(this.requestStateData.getNextCallIdStrForManualAction()).appendPageInfoMetrics().appendPageAction(n).appendPerfPhaseInfo().appendStartAndEndTime(this.manualActionData.startTime,this.manualActionData.endTime).appendToken(this.requestStateData.eventToken).appendTimingKPI().appendClientVer().toString(),r=n?(new he).appendPageActionParams(r).toString():null,t={url:e,metadata:{eventId:this.requestStateData.baseEventId+"-"+this.requestStateData.subEventId},body:r,callback:t},this.pendingManualEventRequest.push(t),this.checkAndProcessManualEvens(),this.manualActionData.clear())},me.prototype.checkAndProcessManualEvens=function(){var e=this;if(!(0<this.waitingTimeHandle))if(0!==this.requestStateData.callSubId)for(var t=this.entity.get(se.name);0<this.pendingManualEventRequest.length;){var n=this.pendingManualEventRequest.shift();n&&t.send(n)}else this.waitingTimeHandle=window.setTimeout(function(){e.waitingTimeHandle=0,e.checkAndProcessManualEvens()},200)},me);function me(){var e=null!==ge&&ge.apply(this,arguments)||this;return e.pendingManualEventRequest=[],e.waitingTimeHandle=0,e}var ye,Ee=function(){this.pageUnloaded=!1,this.pageCompleted=!1},Re=(e(we,ye=o),we.prototype.onInit=function(){var e,t=this;this.renderMetricsData=this.entity.get(A.name),this.requestMetricsData=this.entity.get(x.name),this.requestStateData=this.entity.get(I.name),this.pageLifecycleData=this.entity.get(Ee.name),this.manualActionData=this.entity.get(le.name),this.renderMetricsData.enableSendMetrics=(!(e=document.getElementById("PerfLog.requestMetricsReportEnable"))||"false"!==e.content)&&O(window.location.href),this.entity.once(i.PAGE_INIT,function(){t.onPageInit()}).once(i.PAGE_LOADED,function(){t.requestStateData.eventId=function(){if(S)return S;var e=document.getElementById("PerfLog.eventId");return S=(null==e?void 0:e.content)||null}(),t.requestStateData.initialEventsStats()}).once(i.PAGE_COMPLETED,function(){t.onPageCompleted()}).once(i.PAGE_UNLOAD,function(){window.sessionStorage.setItem(f,document.referrer),window.sessionStorage.setItem(g,Date.now()+"")})},we.prototype.onPageCompleted=function(){var e=this;this.entity.on(i.DEFERRED_LAST_API_RESPONSE,function(){e.sendMetrics()})},we.prototype.onPageInit=function(){var e,t,n=sessionStorage.getItem(f),r=sessionStorage.getItem(g),i=function(e,t){var n=e+"=";if(0<=(e=t.indexOf(n))){n=t.indexOf(";",e+=n.length);return n<e&&(n=t.length),t.substring(e,n)}return null}("initiateContextInfo",document.cookie);i&&(i=decodeURIComponent(i),e=0,r&&n&&n==document.referrer&&!!(t=document.getElementById("PerfLog.usePageRequestStartTime"))&&"false"!==t.content&&(e=null!==(t=parseInt(r))&&void 0!==t?t:0),this.requestMetricsData.initPageTrack(i,e),document.cookie="initiateContextInfo=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/"),n&&sessionStorage.removeItem(f),r&&sessionStorage.removeItem(g)},we.prototype.sendMetrics=function(){var e,t;this.pageLifecycleData.pageUnloaded||(this.renderMetricsData.endTrack(this.requestStateData.lastAPIEndTime-this.requestStateData.firstAPIStartTime),this.renderMetricsData.enableSendMetrics&&(t={url:e=new he(window.PerfLog.callURL).appendCallId(this.requestStateData.getNextCallIdStringForSendMetrics()).appendPageInfoMetrics().appendPerfPhaseInfo().appendRequestStateData(this.requestStateData).appendRenderMetricsData(this.renderMetricsData).appendToken(this.requestStateData.eventToken).appendTimingKPI().appendClientVer().toString(),body:(new he).appendRequestMetricsData(this.requestMetricsData).appendPageActionParams(this.manualActionData.initialPageActionParams).toString(),metadata:{eventId:null===(t=this.requestStateData.eventStats)||void 0===t?void 0:t.EID}},this.entity.get(se.name).send(t),function(e){var t="perfLogData0";if(!document.getElementById(t))try{var n=document.createElement("meta");n.id=t,n.content=JSON.stringify(new v(e).toJSON()),document.getElementsByTagName("head")[0].appendChild(n)}catch(e){console.error(e)}}(e)),this.requestStateData.clear(),this.renderMetricsData.clear(),this.requestMetricsData.clear(),this.manualActionData.initialPageActionParams=null,console.log("--------- Event ended ---------"))},we);function we(){return null!==ye&&ye.apply(this,arguments)||this}var Se,qe=(e(Pe,Se=o),Pe.prototype.onInit=function(){this.pageLifecycleData=this.entity.get(Ee.name)},Pe.prototype.initPageLifecycleEventListeners=function(){var e,t,n=this;this.hasListenPageLifecycleEvent||(this.hasListenPageLifecycleEvent=!0,this.entity.emit(new i(i.PAGE_INIT)),e=function(){n.onBrowserPageLoad()},t=function(){n.pageLifecycleData.pageUnloaded||(n.pageLifecycleData.pageUnloaded=!0,n.entity.emit(new i(i.PAGE_UNLOAD)))},window.SFDOMEvent?(window.SFDOMEvent.addOnDomReadyListener(e),window.SFDOMEvent.addEventListener(window,"beforeunload",t)):window.jQuery?(window.jQuery(e),window.jQuery(window).bind("beforeunload",t)):(window.addEventListener("DOMContentLoaded",e),window.addEventListener("beforeunload",t)))},Pe.prototype.onBrowserPageLoad=function(){var e=this;this.entity.emit(new i(i.PAGE_LOADED)),window.PerfPhase&&window.PerfPhase.isActive()?window.PerfPhase.attach("TML",function(){e.pageLifecycleData.pageCompleted||(e.pageLifecycleData.pageCompleted=!0,e.entity.emit(new i(i.PAGE_COMPLETED)))}):this.pageLifecycleData.pageCompleted||(this.pageLifecycleData.pageCompleted=!0,this.entity.emit(new i(i.PAGE_COMPLETED)))},Pe);function Pe(){var e=null!==Se&&Se.apply(this,arguments)||this;return e.hasListenPageLifecycleEvent=!1,e}var De=(be.prototype.emit=function(n){var r=this;if(!this.listenersDic)return this;var i=this.listenersDic.get(n.eventName);return i&&i.forEach(function(e){var t;null!==(t=r.onceListeners)&&void 0!==t&&t.has(e)&&(i.delete(e),r.onceListeners.delete(e)),e(n)}),this},be.prototype.addEventListener=function(e,t,n){var r,i;null!==(r=this.onceListeners)&&void 0!==r&&r.has(t)||null!==(i=null===(i=this.listenersDic)||void 0===i?void 0:i.get(e))&&void 0!==i&&i.has(t)||(this.listenersDic=null!==(i=this.listenersDic)&&void 0!==i?i:new Map,(i=this.listenersDic.get(e))||(i=new Set,this.listenersDic.set(e,i)),i.add(t),n&&(this.onceListeners||(this.onceListeners=new Set),this.onceListeners.add(t)))},be.prototype.on=function(e,t){return this.addEventListener(e,t,!1),this},be.prototype.once=function(e,t){return this.addEventListener(e,t,!0),this},be.prototype.off=function(e,t){var n;return t?null!==(n=null===(n=this.listenersDic)||void 0===n?void 0:n.get(e))&&void 0!==n&&n.delete(t):null!==(e=null===(t=this.listenersDic)||void 0===t?void 0:t.get(e))&&void 0!==e&&e.clear(),this},be.prototype.hasListener=function(e){var t;return null!==(t=null===(t=this.listenersDic)||void 0===t?void 0:t.has(e))&&void 0!==t&&t&&0<(null!==(e=null===(e=null===(t=this.listenersDic)||void 0===t?void 0:t.get(e))||void 0===e?void 0:e.size)&&void 0!==e?e:0)},be);function be(){this.listenersDic=null,this.onceListeners=null}var Ie,Te=(e(Ae,Ie=De),Ae.prototype.set=function(e,t){this.attributes.set(e,t)},Ae.prototype.get=function(e){return this.attributes.get(e)},Ae.prototype.has=function(e){return this.attributes.has(e)},Ae);function Ae(e){var t,n,r,i=Ie.call(this)||this;if(i.attributes=new Map,i.pluginsMap=new Map,e){if(e.pluginConstructors)try{for(var o=p(e.pluginConstructors),a=o.next();!a.done;a=o.next()){var s=a.value,u=new s(i),l=s.name;i.pluginsMap.set(l,u),i.attributes.set(l,u)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}e.attributes&&(r=e.attributes,Object.keys(r).forEach(function(e){i.attributes.set(e,r[e])}))}return i.pluginsMap.forEach(function(e){e.onInit()}),i}function Le(e,t){var n;null!==(n=e.name)&&void 0!==n||(e.name=t)}var Ce=new URLSearchParams(window.location.search);function xe(e){return Ce.get(e)}Object.defineProperty(He.prototype,"pageAction",{get:function(){return this._perfLogEntity.get(le.name).pageAction},set:function(e){this._perfLogEntity.get(le.name).pageAction=e},enumerable:!1,configurable:!0}),Object.defineProperty(He.prototype,"pageActionParams",{get:function(){return this._perfLogEntity.get(le.name).pageActionParams},set:function(e){this._perfLogEntity.get(le.name).pageActionParams=e},enumerable:!1,configurable:!0}),Object.defineProperty(He.prototype,"initialPageActionParams",{get:function(){return this._perfLogEntity.get(le.name).initialPageActionParams},set:function(e){this._perfLogEntity.get(le.name).initialPageActionParams=e},enumerable:!1,configurable:!0}),He.prototype.addOnloadHook=function(e){e&&(this.callURL=e),this._perfLogEntity.get(qe.name).initPageLifecycleEventListeners()},He.prototype.onPageComplete=function(){console.warn("onPageComplete is an internal function and will not exposed to new perflog anymore.")},He.prototype.pageUnload=function(){this._perfLogEntity.get(Ee.name).pageUnloaded=!0},He.prototype.pageComplete=function(e){this._perfLogEntity.get(Ee.name).pageCompleted?e():this._perfLogEntity.once(i.PAGE_COMPLETED,function(){try{e()}catch(e){console.error(e)}})},He.prototype.startManualEvent=function(){this._perfLogEntity.get(ve.name).startManualEvent()},He.prototype.endManualEvent=function(e,t){this._perfLogEntity.get(ve.name).endManualEvent(e,t)},He.prototype.getPendingAjaxCount=function(){return this._perfLogEntity.get(I.name).pendingAPICallCount},He.prototype.getEventId=function(){var e;return null!==(e=null===(e=P())||void 0===e?void 0:e.EID)&&void 0!==e?e:""},He.prototype.onRequestStart=function(t){function e(e){try{t(e.detail)}catch(e){console.error(e)}}var n=this;return this._perfLogEntity.on(i.Request_START,e),function(){n._perfLogEntity.off(i.Request_START,e)}},He.prototype.onRequestEnd=function(t){function e(e){try{t(e.detail)}catch(e){console.error(e)}}var n=this;return this._perfLogEntity.on(i.Request_END,e),function(){n._perfLogEntity.off(i.Request_END,e)}},o=He;function He(){var e=this;this.callURL="/perfLogServlet",this.buildVersion="1.0.18",this.buildDate="2023-03-30T08:11:09.859Z";var t,n=new l;n.supportServiceWorker="true"===xe("perflog-support-sw"),n.monitorXmlHttpRequest="true"===(t=xe("perflog-monitor-xhr"))||"false"!==t,n.monitorFetch="true"===(t=xe("perflog-monitor-fetch"))||"false"!==t&&(window.fetch&&!window.fetch.polyfill),n.monitorRequestUrlBlockList=[/^((https?:)?\/\/[^/]+)?\/(ui|verp)\//,/\/intake\/v.+\/rum\/event/,/\/jsup/],"ActiveXObject"in window&&(Le(ve,"ManualActionTracker"),Le(Re,"MetricsReporter"),Le(ne,"APIRequestMonitor"),Le(se,"ServletService"),Le(qe,"PageManager"),Le(l,"FeaturesData"),Le(le,"ManualActionData"),Le(A,"RenderMetricsData"),Le(x,"RequestMetricsData"),Le(I,"RequestStateData"),Le(Ee,"PageLifecycleData")),this._perfLogEntity=new Te({pluginConstructors:[ve,Re,ne,se,qe],attributes:((t={})[l.name]=n,t[le.name]=new le,t[A.name]=new A,t[x.name]=new x,t[I.name]=new I,t[Ee.name]=new Ee,t)}),this._perfLogEntity.once(i.PAGE_COMPLETED,function(){console.info("PerfLog Page Completed (ver:"+e.buildVersion+" "+e.buildDate+")")})}null!==(De=window.PerfLog)&&void 0!==De||(window.PerfLog=new o)}();
